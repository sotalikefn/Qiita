# 記事アイデア：npmからpnpmへの移行ガイド

## 基本情報
- 作成日: 2025-05-21
- ステータス: [ ] アイデア段階 [x] 調査中 [ ] 執筆中 [ ] 完了

## 概要
npmユーザーに向けて、pnpmの利点と移行のメリット・デメリットを解説。特にnodebrewユーザーに向けた具体的な設定手順とベストプラクティスを紹介する。

## 想定読者
- 現在npmを使用している開発者
- より効率的なパッケージ管理を求めている開発者
- nodebrewでNode.jsのバージョン管理をしている開発者
- モノレポ構成を検討している開発者

## 主なポイント

### 1. pnpmの特徴と利点

#### 🔥 pnpm が優れているポイント

| 比較項目            | pnpm                                  | npm                                |
|---------------------|---------------------------------------|-------------------------------------|
| インストール速度     | ✅ 速い（ハードリンク使用）            | 遅め                                |
| ディスク使用量       | ✅ 少ない（依存を共有）                | 多い（プロジェクトごとに重複）      |
| 依存の厳格性         | ✅ 厳格（バグの早期発見につながる）     | 緩い                                |
| モノレポ対応         | ✅ 優秀（pnpm workspaces）            | 普通（npm v7以降対応）              |
| キャッシュ管理       | ✅ 賢い                                | 普通                                |
| 互換性               | 一部ツールで注意が必要                | ✅ 最も広くサポートされている        |

#### 👎 pnpm の注意点
- 一部ツールやスクリプトが pnpm 非対応
- チームで npm 前提の場合、導入前に要調整

### 2. npmとの比較
- パフォーマンスの違い
- ディスク使用量の違い
- 依存関係の解決方法の違い
- `package-lock.json` vs `pnpm-lock.yaml`

### 3. nodebrewユーザー向けのセットアップ

#### 🧭 corepackの活用
- Node.js v16.10以降にバンドルされているツール
- `pnpm`, `yarn` の**バージョン管理と自動実行**ができるラッパー
- `npm` の代替ではなく、補完的なツール

#### 🔧 基本的なセットアップ手順
```bash
# 初回のみ
corepack enable

# 任意のバージョンの pnpm を使う
corepack prepare pnpm@8.15.4 --activate

# package.json にバージョンを固定
{
  "packageManager": "pnpm@8.15.4"
}
```

#### ❓ nodebrewでの注意点
- `nodebrew` で Node.js を切り替えた場合、各バージョンで1回だけ `corepack enable` が必要
- 切り替えた先のバージョンで既に有効化済みの場合は再実行不要

#### 🧪 設定の確認方法
```bash
which pnpm
```
パスが `~/.nodebrew` 以下であれば、corepack 経由で呼び出されている

### 4. 実践的なTips
- よく使うコマンドの比較（npm vs pnpm）
- pnpm-workspace.yamlの設定
- CI/CDでの注意点

## 参考資料
- [pnpm公式ドキュメント](https://pnpm.io/)
- [Node.js Corepack documentation](https://nodejs.org/api/corepack.html)
- 実際のプロジェクトでの移行経験

## メモ
- nodebrewでの新規バージョンインストール時のワークフロー図を作成
- 実際のプロジェクトでの移行手順のスクリーンショットを準備
- パフォーマンス比較のベンチマークを取得

## TODO
- [ ] パフォーマンスベンチマークの実施
- [ ] モノレポでの具体的な使用例の作成
- [x] nodebrewでの設定手順の詳細な検証
- [ ] 既存プロジェクトの移行手順の検証 